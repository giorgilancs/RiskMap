<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fitting of decay-adjusted spatio-temporal (DAST) model — dast • RiskMap</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting of decay-adjusted spatio-temporal (DAST) model — dast"><meta name="description" content="The function fits a decay-adjusted spatio-temporal (DAST) model using Monte Carlo maximum liklihood.
The DAST model allows for the incorporation of the temporal decay in diease prevalence due
to the impact of mass drug administration (MDA). The function requires the full MDA history as detailed in the arguments below."><meta property="og:description" content="The function fits a decay-adjusted spatio-temporal (DAST) model using Monte Carlo maximum liklihood.
The DAST model allows for the incorporation of the temporal decay in diease prevalence due
to the impact of mass drug administration (MDA). The function requires the full MDA history as detailed in the arguments below."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RiskMap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fitting of decay-adjusted spatio-temporal (DAST) model</h1>

      <div class="d-none name"><code>dast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function fits a decay-adjusted spatio-temporal (DAST) model using Monte Carlo maximum liklihood.
The DAST model allows for the incorporation of the temporal decay in diease prevalence due
to the impact of mass drug administration (MDA). The function requires the full MDA history as detailed in the arguments below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dast</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  den <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">mda_times</span>,</span>
<span>  <span class="va">int_mat</span>,</span>
<span>  penalty <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sst <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">power_val</span>,</span>
<span>  crs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  convert_to_crs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scale_to_km <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  control_mcmc <span class="op">=</span> <span class="fu"><a href="set_control_sim.html">set_control_sim</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  par0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  S_samples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  return_samples <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  messages <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  start_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="cn">NULL</span>, sigma2 <span class="op">=</span> <span class="cn">NULL</span>, tau2 <span class="op">=</span> <span class="cn">NULL</span>, phi <span class="op">=</span> <span class="cn">NULL</span>, psi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    sigma2_re <span class="op">=</span> <span class="cn">NULL</span>, gamma <span class="op">=</span> <span class="cn">NULL</span>, alpha <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A model formula specifying the response variable and predictors.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A `data.frame` or `sf` object containing the dataset.</p></dd>


<dt id="arg-den">den<a class="anchor" aria-label="anchor" href="#arg-den"></a></dt>
<dd><p>The denominator for binomial models.</p></dd>


<dt id="arg-mda-times">mda_times<a class="anchor" aria-label="anchor" href="#arg-mda-times"></a></dt>
<dd><p>A vector specifying the mass drug administration (MDA) times.</p></dd>


<dt id="arg-int-mat">int_mat<a class="anchor" aria-label="anchor" href="#arg-int-mat"></a></dt>
<dd><p>Intervention matrix specifying the timing and coverage of MDA; the dimension of the matrix
must be <code>n * n_mda</code>, where <code>n</code> is the number of rows of <code>data</code> and <code>n_mda</code> is the length of <code>mda_times</code>.</p></dd>


<dt id="arg-penalty">penalty<a class="anchor" aria-label="anchor" href="#arg-penalty"></a></dt>
<dd><p>Optional list specifying penalty functions for regularization, used in the estimation of the "drop" parameter <code>alpha</code>.</p></dd>


<dt id="arg-drop">drop<a class="anchor" aria-label="anchor" href="#arg-drop"></a></dt>
<dd><p>Optional value used for fixing the "drop" parameter of the MDA impact function.</p></dd>


<dt id="arg-power-val">power_val<a class="anchor" aria-label="anchor" href="#arg-power-val"></a></dt>
<dd><p>Value expressing the power of the MDA impact function.</p></dd>


<dt id="arg-crs">crs<a class="anchor" aria-label="anchor" href="#arg-crs"></a></dt>
<dd><p>Optional coordinate reference system (CRS) for spatial data.</p></dd>


<dt id="arg-convert-to-crs">convert_to_crs<a class="anchor" aria-label="anchor" href="#arg-convert-to-crs"></a></dt>
<dd><p>CRS to which spatial data should be converted.</p></dd>


<dt id="arg-scale-to-km">scale_to_km<a class="anchor" aria-label="anchor" href="#arg-scale-to-km"></a></dt>
<dd><p>Logical; whether to scale distances to kilometers (default: `TRUE`).</p></dd>


<dt id="arg-control-mcmc">control_mcmc<a class="anchor" aria-label="anchor" href="#arg-control-mcmc"></a></dt>
<dd><p>A list of MCMC control parameters, typically from `set_control_sim()`.</p></dd>


<dt id="arg-par-">par0<a class="anchor" aria-label="anchor" href="#arg-par-"></a></dt>
<dd><p>Optional list of initial parameter values.</p></dd>


<dt id="arg-s-samples">S_samples<a class="anchor" aria-label="anchor" href="#arg-s-samples"></a></dt>
<dd><p>Number of posterior samples to retain.</p></dd>


<dt id="arg-return-samples">return_samples<a class="anchor" aria-label="anchor" href="#arg-return-samples"></a></dt>
<dd><p>Logical; whether to return posterior samples (default: `TRUE`).</p></dd>


<dt id="arg-messages">messages<a class="anchor" aria-label="anchor" href="#arg-messages"></a></dt>
<dd><p>Logical; whether to print messages (default: `TRUE`).</p></dd>


<dt id="arg-start-pars">start_pars<a class="anchor" aria-label="anchor" href="#arg-start-pars"></a></dt>
<dd><p>List of starting values for parameters.</p></dd>


<dt id="arg-survey-times">survey_times<a class="anchor" aria-label="anchor" href="#arg-survey-times"></a></dt>
<dd><p>The variable indicating the survey times.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing model estimates, posterior samples, and metadata.</p>
<p>A list containing:</p>
<p>- `y`: Response variable values.
- `D`: Covariate matrix.
- `coords`: Unique spatial coordinates.
- `mda_times`: MDA time points.
- `survey_times_data`: Survey time data.
- `int_mat`: Intervention matrix.
- `ID_coords`: Indices of spatial locations.
- `re`: Random effects levels (if applicable).
- `ID_re`: Indices of random effects (if applicable).
- `power_val`: Power of the MDA impact function.
- `fix_tau2`: Fixed tau-squared value (if applicable).
- `fix_alpha`: Fixed alpha value (if applicable).
- `formula`: Model formula.
- `crs`: Coordinate reference system.
- `scale_to_km`: Indicator of distance scaling.
- `data_sf`: Processed spatial dataset.
- `family`: Model family (e.g., "binomial").
- `kappa`: Smoothness parameter.
- `units_m`: Denominator for binomial models.
- `cov_offset`: Offset for covariates.
- `call`: Function call.
- `penalty`: Penalty function details (if applicable).
- `posterior_samples`: Posterior samples if `return_samples = TRUE`.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="set_control_sim.html">set_control_sim</a></code>, <code><a href="summary.RiskMap.html">summary.RiskMap</a></code>, <code><a href="to_table.html">to_table</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a></p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emanuele Giorgi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

