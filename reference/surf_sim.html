<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate surface data based on a spatial model — surf_sim • RiskMap</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate surface data based on a spatial model — surf_sim"><meta name="description" content="This function simulates surface data based on a user-defined formula and other parameters. It allows for simulation of spatial data with various model families (Gaussian, Binomial, or Poisson). The simulation involves creating spatially correlated random fields and generating outcomes for data points in a given prediction grid."><meta property="og:description" content="This function simulates surface data based on a user-defined formula and other parameters. It allows for simulation of spatial data with various model families (Gaussian, Binomial, or Poisson). The simulation involves creating spatially correlated random fields and generating outcomes for data points in a given prediction grid."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RiskMap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate surface data based on a spatial model</h1>

      <div class="d-none name"><code>surf_sim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function simulates surface data based on a user-defined formula and other parameters. It allows for simulation of spatial data with various model families (Gaussian, Binomial, or Poisson). The simulation involves creating spatially correlated random fields and generating outcomes for data points in a given prediction grid.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">surf_sim</span><span class="op">(</span></span>
<span>  <span class="va">n_sim</span>,</span>
<span>  <span class="va">pred_grid</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">sampling_f</span>,</span>
<span>  <span class="va">family</span>,</span>
<span>  scale_to_km <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  control_mcmc <span class="op">=</span> <span class="fu"><a href="set_control_sim.html">set_control_sim</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">par0</span>,</span>
<span>  nugget_over_grid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include_covariates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fix_var_me <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  messages <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n-sim">n_sim<a class="anchor" aria-label="anchor" href="#arg-n-sim"></a></dt>
<dd><p>The number of simulations to run.</p></dd>


<dt id="arg-pred-grid">pred_grid<a class="anchor" aria-label="anchor" href="#arg-pred-grid"></a></dt>
<dd><p>A spatial object (either `sf` or `data.frame`) representing the prediction grid where the simulation will take place.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A formula object specifying the model to be fitted. It should include both fixed effects and random effects if applicable.</p></dd>


<dt id="arg-sampling-f">sampling_f<a class="anchor" aria-label="anchor" href="#arg-sampling-f"></a></dt>
<dd><p>A function that returns a sampled dataset (of class `sf` or `data.frame`) to simulate data from.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>A character string specifying the family of the model. Must be one of "gaussian", "binomial", or "poisson".</p></dd>


<dt id="arg-scale-to-km">scale_to_km<a class="anchor" aria-label="anchor" href="#arg-scale-to-km"></a></dt>
<dd><p>A logical indicating whether the coordinates should be scaled to kilometers. Defaults to `TRUE`.</p></dd>


<dt id="arg-control-mcmc">control_mcmc<a class="anchor" aria-label="anchor" href="#arg-control-mcmc"></a></dt>
<dd><p>A list of control parameters for MCMC (not used in this implementation but can be expanded later).</p></dd>


<dt id="arg-par-">par0<a class="anchor" aria-label="anchor" href="#arg-par-"></a></dt>
<dd><p>A list containing initial parameter values for the simulation, including `beta`, `sigma2`, `phi`, `tau2`, and `sigma2_me`.</p></dd>


<dt id="arg-nugget-over-grid">nugget_over_grid<a class="anchor" aria-label="anchor" href="#arg-nugget-over-grid"></a></dt>
<dd><p>A logical indicating whether to include a nugget effect over the entire prediction grid.</p></dd>


<dt id="arg-include-covariates">include_covariates<a class="anchor" aria-label="anchor" href="#arg-include-covariates"></a></dt>
<dd><p>A logical indicateing if the covariates (or the intercept if no covariates are used) should be included in the linear
predictor. By default <code>include_covariates = TRUE</code></p></dd>


<dt id="arg-fix-var-me">fix_var_me<a class="anchor" aria-label="anchor" href="#arg-fix-var-me"></a></dt>
<dd><p>A parameter to fix the variance of the random effects for the measurement error. Defaults to `NULL`.</p></dd>


<dt id="arg-messages">messages<a class="anchor" aria-label="anchor" href="#arg-messages"></a></dt>
<dd><p>A logical value indicating whether to print messages during the simulation. Defaults to `TRUE`.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the simulated data (<code>data_sim</code>), the linear predictors (<code>lp_grid_sim</code>),
a logical value indicating if covariates have been included in the linear predictor (<code>include_covariates</code>),
a logical value indicating if the nugget has been included into the simulations of the linear predictor over the grid
(<code>nugget_over_grid</code>), a logical  indicating if a covariate offset has been included in the linear predictor (<code>include_cov_offset</code>),
the model parameters set for the simulation (<code>par0</code>) and the family used in the model (<code>family</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emanuele Giorgi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

